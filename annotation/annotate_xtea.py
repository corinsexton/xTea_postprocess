#!/usr/bin/env python

import pyranges as pr, pandas as pd
import argparse


parser = argparse.ArgumentParser()
parser.add_argument("dataset",help = 'dataset (LFS or PCAWG)')
parser.add_argument("gff_file",help = 'gff3 annotation file')
parser.add_argument("vcf_file",help = 'vcf annotation file')
parser.add_argument("outfile",help = 'output_tsv file')
args = parser.parse_args()


ann = pr.read_gff3(args.gff_file)
introns = ann.features.introns(by="gene")
tss = ann.features.tss()

ann_all = pd.concat([ann.df,introns.df,tss.df])
ann_all.drop(ann_all[ann_all.Feature == "CDS"].index,inplace = True)
ann_all.drop(ann_all[ann_all.Feature == "gene"].index,inplace = True)
ann_all.drop(ann_all[ann_all.Feature == "transcript"].index,inplace = True)

ann_all = pr.PyRanges(ann_all)

with open(args.vcf_file) as vcf_file:
	line = vcf_file.readline()
	while line[0:2] == '##':
		line = vcf_file.readline()
	header = line.strip().split()


vcf = pd.read_csv(args.vcf_file, sep="\t", comment='#',names = header)
vcf = vcf.rename({"#CHROM": "Chromosome"}, axis=1)
vcf = vcf.rename({"POS": "Start"}, axis=1)
vcf['End'] = vcf.INFO.str.split(';').str[2].replace('END=','',regex = True)

vcf = pr.PyRanges(vcf)


# col names:
#Index(['Chromosome', 'Source', 'Feature', 'Start', 'End', 'Score', 'Strand',
#       'Frame', 'ID', 'Parent', 'gene_id', 'transcript_id', 'gene_type',
#       'gene_name', 'transcript_type', 'transcript_name', 'exon_number',
#       'exon_id', 'level', 'transcript_support_level', 'tag',
#       'havana_transcript', 'hgnc_id', 'ont', 'havana_gene', 'protein_id',
#       'ccdsid', 'Start_b', 'ID_b', 'REF', 'ALT', 'QUAL', 'FILTER', 'INFO',
#       'FORMAT', '2349', '2760A', '3425', '3432', '3506', '3687_2', '4028',
#       '4269', '4329', '4535', '4854', '4942', '5535', '5536', '5537', '5539',
#       '5540', '5541', '5542', '5543', '5544', '5567', 'End_b'],
#      dtype='object')
intersects = ann_all.join(vcf,how = 'right',slack = 35)
intersects = intersects.sort(by = "Start_b")

out = intersects.df

if args.dataset == 'LFS':
	out = out[["Chromosome","Start_b","End_b","REF","ALT","ID_b","Feature","Parent","gene_name","exon_number","exon_id",
					'2349', '2760A', '3425', '3432', '3506', '3687_2', '4028',
					'4269', '4329', '4535', '4854', '4942', '5535', '5536', '5537', '5539',
					'5540', '5541', '5542', '5543', '5544', '5567']]

elif args.dataset == 'PCAWG':
	out = out[["Chromosome","Start_b","End_b","REF","ALT","ID_b","Feature","Parent","gene_name","exon_number","exon_id",
	'PCAWG.01db3f49-af1e-4779-803b-b2e516a9fbfd_hg38', 'PCAWG.02076e93-5959-457a-a8df-4315d1df315b_hg38', 'PCAWG.032fdab7-fae5-4396-9afe-cbe56eff51c2_hg38', 'PCAWG.03e8aa4f-c18e-422d-ac34-c8c0a66f6fae_hg38', 'PCAWG.06075f42-8b30-47ad-bdf8-44eaaf93353a_hg38', 'PCAWG.06215dfc-0723-4504-b2c8-cabf2deeae36_hg38', 'PCAWG.06cfbe02-7034-4aa7-bdb1-1b6abe66c510_hg38', 'PCAWG.075a1c91-81a7-488c-8186-d3e6c3f80dd9_hg38', 'PCAWG.0b1eb200-2ff5-4b6e-9c76-9a4037f6d28c_hg38', 'PCAWG.0b3afa83-63da-46c4-b8e2-2c3d862a477e_hg38', 'PCAWG.0c94142b-9447-42e9-81c4-022392108769_hg38', 'PCAWG.0c9e10aa-066a-4e2f-95a4-44a4305aca01_hg38', 'PCAWG.0d688721-f4f7-4844-9667-1febb043e7d9_hg38', 'PCAWG.0dd5ec83-1deb-4789-8d51-740c47afca6d_hg38', 'PCAWG.0df001ee-102e-46e6-9dad-9eb56ab5efd0_hg38', 'PCAWG.0e7b8948-9007-450a-ac99-435372419b17_hg38', 'PCAWG.10108b65-f1b1-4e08-947c-ffb4afe52380_hg38', 'PCAWG.10b944ea-7df7-467c-9565-184b9d056d1d_hg38', 'PCAWG.10d7c81b-8f5b-4db9-ae69-6ef1eed7a312_hg38', 'PCAWG.112d3850-3998-4b64-9be8-1fa5ef4f6699_hg38', 'PCAWG.116cd62c-e26b-48d8-93d4-456d2834270c_hg38', 'PCAWG.13b08dce-ca5b-4231-bfde-dea1f6ebebab_hg38', 'PCAWG.13e1ffcf-3f08-4378-bcf7-544a8a9a9462_hg38', 'PCAWG.14738970-d078-48a1-9406-50b618f50430_hg38', 'PCAWG.148d6d04-58a3-4a42-a46f-dde18a1d4048_hg38', 'PCAWG.14910258-2cf0-4821-a5ce-46fe18cd423c_hg38', 'PCAWG.15292b67-fb52-44e9-bdee-6c4ab861de4b_hg38', 'PCAWG.16427f3e-48cc-4bbe-89f5-e7f3b082838d_hg38', 'PCAWG.1978ee44-b401-42c7-b26b-e8e0fe005d8b_hg38', 'PCAWG.19efc6e3-91dc-456d-9a03-38ccc7f71f42_hg38', 'PCAWG.1a62410d-385d-4407-98cf-052ed03fb880_hg38', 'PCAWG.1b3d2513-b7c8-49bd-85a2-401d039bcc78_hg38', 'PCAWG.1c577996-445b-4ec9-a0a6-f16f6f0e4949_hg38', 'PCAWG.20da574d-e106-4421-b8e2-22626843d8e0_hg38', 'PCAWG.210661d3-a12d-45f4-9fea-a61833fcf3e0_hg38', 'PCAWG.21e693bb-4111-4375-8b4f-99f46fbcd0e8_hg38', 'PCAWG.22199b3d-c92b-4d22-a17c-665a358923c2_hg38', 'PCAWG.222f5df2-cab8-4e0f-8e65-cfb1862779ca_hg38', 'PCAWG.264cfe35-419a-41f4-a3c0-7650110f1d4a_hg38', 'PCAWG.2822d1ec-93ee-48b2-b1d6-d66fd3cc9f49_hg38', 'PCAWG.285f164e-24f4-4bb5-8cf7-ae27f2b97d54_hg38', 'PCAWG.28910fb1-918f-4ca5-b9d2-1da4bf2f23e9_hg38', 'PCAWG.28fb9c22-3ad7-45f6-ab6b-e2c01f92cda5_hg38', 'PCAWG.2980bd39-5e30-4e15-8ed1-b5e0b0d680db_hg38', 'PCAWG.2d01a5c9-bd19-4b43-88c1-694f8561b21a_hg38', 'PCAWG.2d0cad3e-d54d-4980-b3bf-dd49cddf06f3_hg38', 'PCAWG.2d6ae7b6-ff7d-41ca-9991-69342b8d215d_hg38', 'PCAWG.2da82aa9-fceb-4b84-9be8-85a14a1863a6_hg38', 'PCAWG.2e50e70c-2ee7-479d-b537-4d338e59e0f4_hg38', 'PCAWG.2eee6dff-8697-4a12-b496-9843b68f137b_hg38', 'PCAWG.30708eaf-d667-4891-b3f3-74f821848820_hg38', 'PCAWG.309c3262-0059-447c-8ea1-f57a4779bd78_hg38', 'PCAWG.30ff58e4-5016-42ed-a2d6-2a62762a39ac_hg38', 'PCAWG.31089e68-8da7-4b5e-9098-ba08b1d89020_hg38', 'PCAWG.311ec0ec-d4a4-4d45-b6d8-f2c1dca1b611_hg38', 'PCAWG.3185c99a-b8ff-46a6-bd0a-c78bf9ddb24a_hg38', 'PCAWG.31daf4a9-8a05-4b7c-a35e-0ca2518a448f_hg38',
	'PCAWG.32c0bc4b-0397-46b1-bee2-983f423ae9f1_hg38', 'PCAWG.33636177-6ff6-4aec-bb5b-d4ff2f5d75d3_hg38', 'PCAWG.34498a3b-9e30-48b7-9f8e-0beb7aa8c41b_hg38', 'PCAWG.349643c8-361a-4082-a227-5632581ebffd_hg38', 'PCAWG.34c4d97e-3a3f-46cb-89fb-4377608fd411_hg38', 'PCAWG.3549d107-3707-4bda-9e2d-7968b6016e44_hg38', 'PCAWG.36a9a61f-d645-4e23-885d-b8fd695d4f65_hg38', 'PCAWG.37a74c04-fdc4-4a7f-a50d-02402b0ea27d_hg38', 'PCAWG.37f10089-d391-4788-bdb0-db8097858ace_hg38', 'PCAWG.385801ff-b732-4515-8c7d-ca2a71ee83e1_hg38', 'PCAWG.38c6b56f-3b06-46ea-be92-9acba8cf0a75_hg38', 'PCAWG.3a87c1c6-c85e-41de-8871-01906570498a_hg38', 'PCAWG.3c0ba0ab-b755-4ecf-9804-79bfb0c6cc94_hg38', 'PCAWG.3c15988d-63aa-4c02-9888-d64200e8e233_hg38', 'PCAWG.3c879c6c-ea75-459f-8b88-44667106c64d_hg38', 'PCAWG.3d1f5fa7-3ebb-4386-ba47-b78defdbffce_hg38', 'PCAWG.3d95af3d-2577-45f1-b519-b43245d4a9bf_hg38', 'PCAWG.3fa326fb-473e-49c6-888a-8774c1beed5d_hg38', 'PCAWG.40f17cc9-6b09-4937-a4f5-04d6cf782f3d_hg38', 'PCAWG.41108cf9-29fa-4504-92a0-e88c31d6aac1_hg38', 'PCAWG.422bf639-ec3e-4892-9d20-7180d3f6f949_hg38', 'PCAWG.424137c1-f6fb-4eef-8ddf-4219a334476f_hg38', 'PCAWG.427bd443-8b47-4dc3-b03d-ad72b399b8d5_hg38', 'PCAWG.4388027d-8766-466a-b3a3-d22cde9a0796_hg38', 'PCAWG.43e44e9e-fc3e-479c-ac35-e3c82b77ffd2_hg38', 'PCAWG.4544b1d3-bd47-4921-a049-7f4702b75f31_hg38', 'PCAWG.45840782-3434-45f4-be3b-b0d2ea92ec0b_hg38', 'PCAWG.45bf7cc4-27d4-4f5e-a9b6-94d4ddbdce26_hg38', 'PCAWG.45f50e78-b7a3-439d-a4e0-99e49fa1a6aa_hg38', 'PCAWG.4639f9ce-56a7-4eb7-b17e-09a55a44bee3_hg38', 'PCAWG.46b76580-ab31-4d29-9b6e-cb219d24f114_hg38', 'PCAWG.47d06cf4-a202-4d1d-90c5-bde9d0cb9b49_hg38', 'PCAWG.47de774b-3a6a-4e16-9ef7-e2be04b2b231_hg38', 'PCAWG.48adf55e-2ece-4238-9f55-cb43eab0f4e9_hg38', 'PCAWG.495d4277-309e-4c56-89cc-d90b96ff13c8_hg38', 'PCAWG.49d40d69-bd53-4b70-b66a-a387ac81f5db_hg38', 'PCAWG.4b6bba30-2fa0-44da-a894-92115fbf1dff_hg38', 'PCAWG.4f0df483-8f5f-4f99-af45-83a1b1e7ba4d_hg38', 'PCAWG.4f2e557d-91ed-49ca-9dde-f7fa7f2e5fe0_hg38', 'PCAWG.4f5f4200-a556-4983-946b-62c86b06c9f7_hg38', 'PCAWG.4fafcd08-19db-4e62-87e1-1c8f7ae7349a_hg38', 'PCAWG.511266d0-5247-43f4-b985-4cd20dd674c1_hg38', 'PCAWG.527d8dce-a768-4021-8379-35020e235ec2_hg38', 'PCAWG.5554c8aa-6c03-4036-a360-1ca00d58db57_hg38', 'PCAWG.57584c14-6e6c-4f2c-9430-5444570c79ea_hg38', 'PCAWG.58b5acca-b65f-4f28-8460-69f029681598_hg38', 'PCAWG.593d79fa-2180-4b01-a863-4a31f97f8f9b_hg38', 'PCAWG.5a44dfa6-58b1-40db-b37f-fa8f16c97c94_hg38', 'PCAWG.5aa6bc1b-313e-4468-82bf-7f36178a5167_hg38', 'PCAWG.5e805e5f-06aa-410e-8f3c-00666c5a16f9_hg38', 'PCAWG.5f48841c-6a82-43db-b85b-dea25f332dcd_hg38', 'PCAWG.60708240-98a9-4ad6-ade6-25afa3ed9d6b_hg38', 'PCAWG.60db1294-b88c-45cd-a86c-0db70aca266a_hg38', 'PCAWG.622f7a63-c106-4695-b7e8-52f0870afd9e_hg38', 'PCAWG.62aeed20-8ae0-46b8-8a30-fad4c7b862b9_hg38', 'PCAWG.62d04176-5b45-41b9-8b2a-a629d0c293f3_hg38', 'PCAWG.6398a610-4fa4-4e11-9d0b-4453d6391bfe_hg38', 'PCAWG.63aa58db-4245-4196-be6e-1bfa1382acec_hg38', 
	'PCAWG.667c27e3-f105-4ab6-945b-43840173044d_hg38', 'PCAWG.669fc2e9-c543-43e4-9862-08667463629f_hg38', 'PCAWG.66cbd755-7092-4e10-9530-d49d1af33352_hg38', 'PCAWG.6715a1dd-e2ed-4b94-b8e6-3afc5069ad26_hg38', 'PCAWG.677b02b2-a389-4acd-8b35-266590947e87_hg38', 'PCAWG.67c29fd1-0d64-4967-9218-b6db231ab1cf_hg38', 'PCAWG.67c4645d-cef3-4ac4-97d3-82caf616cdaa_hg38', 'PCAWG.67f559a3-0c79-4be1-b177-d868acb69df2_hg38', 'PCAWG.690738c1-c888-4c61-9333-ef6bb02a7bb8_hg38', 'PCAWG.6931ccd4-0219-4e02-9b64-ab972c613885_hg38', 'PCAWG.6c8bc4a0-5aee-4cfd-96b6-3529ecd41a45_hg38', 'PCAWG.6ce54f18-fe47-44f1-a183-5adaeb967db8_hg38', 'PCAWG.6d13554e-30ea-4bef-95bf-236ffe6a3c3b_hg38', 'PCAWG.6ebad441-fff3-4e7b-b2c8-3c51c06906e9_hg38', 'PCAWG.6efa7310-28ba-4a29-a1e4-22fdb6e6a445_hg38', 'PCAWG.701ee04f-ee1c-42b4-9614-499d51cf4a0a_hg38', 'PCAWG.703cf898-fc2e-435d-9565-63614c8ed614_hg38', 'PCAWG.709f827b-babd-45cf-920c-4a410fd8d16b_hg38', 'PCAWG.7173d8ec-3f8a-4280-8f70-ceb50bcfa798_hg38', 'PCAWG.7224ff30-40ae-4e77-b318-53c7903adccd_hg38', 'PCAWG.7381d26c-3dd4-4468-a0c8-c37c8eb0d0fc_hg38', 'PCAWG.743eaa2e-db6c-4f18-9287-1bece41ca678_hg38', 'PCAWG.75add91f-2b79-45a3-b606-149639973413_hg38', 'PCAWG.7869af5c-3a91-4d7c-a938-80beddd72608_hg38', 'PCAWG.7a2be6a3-f336-43c3-9199-6cf31bd12c78_hg38', 'PCAWG.7a59f1c7-3ec3-4ed9-8a8e-1b9300fc937a_hg38', 'PCAWG.7b3754e5-07c9-462a-8a2b-a10874da7565_hg38', 'PCAWG.7bbdbec1-e777-48e5-8741-51f7be15006f_hg38', 'PCAWG.7c05e2a7-605f-40d4-a54c-c62c8f7d70da_hg38', 'PCAWG.7cdf25e3-d6ca-40e4-bcf9-513d98c06c47_hg38', 'PCAWG.7e71cbaf-d5cd-4bd5-9407-d14b6eebdde6_hg38', 'PCAWG.7fad0c37-d9b0-4f02-9f45-78c66a77e6b5_hg38', 'PCAWG.7ff82d5b-8ad1-4da2-b6bf-f1c746609638_hg38', 'PCAWG.80d8e24d-3ec1-4e43-a28a-4dba015c7fa6_hg38', 'PCAWG.81294e71-9e66-4d60-98d7-a812023e2061_hg38', 'PCAWG.81cd6abf-ba3f-43d3-9423-96defa269f87_hg38', 'PCAWG.831dc242-cb08-47bc-b6c1-77397c828e55_hg38', 'PCAWG.83ad5d8f-ae89-4046-ba54-1e9b39a271c6_hg38', 'PCAWG.840636e2-c7a1-4279-b327-5afaf75e8c1c_hg38', 'PCAWG.849069bd-4533-468d-8bd6-e97598b93a12_hg38', 'PCAWG.85072536-71c2-476a-a0bb-3152d10f8959_hg38', 'PCAWG.85164d74-08d5-46d7-ade8-1c18df5b0116_hg38', 'PCAWG.859ab907-0c65-427a-abdc-ec62d4a2043d_hg38', 'PCAWG.863fe801-c4eb-436c-9410-545a1164e943_hg38', 'PCAWG.8642829e-a04f-4ddd-be41-8f67fe4c4b79_hg38', 'PCAWG.86efd86e-473d-426b-8c00-9ea98427cd64_hg38', 'PCAWG.875731b3-1e9c-4c5e-98c0-45b69efc5f0b_hg38', 'PCAWG.87b8e5c8-5d20-4e54-a6c6-e466973c2e5d_hg38', 'PCAWG.8829bdfc-961c-404f-87a2-222ed55f12c5_hg38', 'PCAWG.8878052e-8907-4bf3-b593-238549d57669_hg38', 'PCAWG.8883aea1-b48e-411f-8d0f-675a4284dd8b_hg38', 'PCAWG.88dbf91d-db76-49b3-8037-96cc9edf152b_hg38', 'PCAWG.8adfb936-62dc-4043-a9b3-2ef28ba8366a_hg38', 'PCAWG.8b94dc69-959c-4a01-b17d-4ce4912ecfad_hg38', 'PCAWG.8c9b6dac-99cc-4375-a754-08d88cefa6fa_hg38', 'PCAWG.8d1f89c8-52e6-427b-94c4-4abb3ef3cf67_hg38', 'PCAWG.8d7c4658-d855-422d-8e1d-495215d4ecf1_hg38', 'PCAWG.8d9ebd2e-9ac6-4d93-81fb-5cfe6f4a4e7a_hg38', 
	'PCAWG.8e314d61-376b-4d8c-9c9d-8561b2fddfb1_hg38', 'PCAWG.8e6bb4f1-0dd1-4098-942d-3766ef2b4777_hg38', 'PCAWG.8eb3ea0c-7607-49b4-ad40-51b6a94580cf_hg38', 'PCAWG.8f6508df-e004-4d63-a68e-26c83f506920_hg38', 'PCAWG.8faa01cf-7759-4f20-aaa0-1aa279cbf114_hg38', 'PCAWG.93d693e7-7ed3-4af3-9c45-7777aab3441a_hg38', 'PCAWG.9493818d-3a8b-43b6-b8e4-db4e0138f5f3_hg38', 'PCAWG.95176ee9-b08d-43f8-875f-ea38c3821778_hg38', 'PCAWG.952b3c9d-b2ce-495f-af26-af6712838857_hg38', 'PCAWG.95773a5f-899f-4bdf-84c5-aab122f1d59a_hg38', 'PCAWG.95a188ed-0b43-4d31-a68f-789397df8bc4_hg38', 'PCAWG.971b9bd9-fd3f-4c12-a330-939b86b6b16b_hg38', 'PCAWG.988e0b49-262b-4cf7-b8bb-26901caf6b76_hg38', 'PCAWG.99a24a62-b4b0-453a-b2a1-c00f135fb3cd_hg38', 'PCAWG.99a3eef8-7d74-4a01-a0ef-c3a4919cece6_hg38', 'PCAWG.9af84343-d84e-4b39-88b3-5a4c394632f7_hg38', 'PCAWG.9b6cd038-dee8-47b3-bd30-9a361a1f39ae_hg38', 'PCAWG.9c53c1a9-33ff-41c5-93b6-c650f15b8db7_hg38', 'PCAWG.9cee1dbd-5fd4-426f-82e2-45c661b1262f_hg38', 'PCAWG.9e028a0d-bfbc-4f09-b6e8-2fedb50e9747_hg38', 'PCAWG.9f5556fa-a937-4945-ae42-a96166d78180_hg38', 'PCAWG.a0963407-05e7-4c84-bfe0-34aacac08eed_hg38', 'PCAWG.a0c324a8-d1e5-4e6f-991a-78bb9dbca668_hg38', 'PCAWG.a1700d48-ef8e-47d6-aa7d-e3ef64c3f183_hg38', 'PCAWG.a1d67724-2719-4a3b-b0e5-dd0e03a61911_hg38', 'PCAWG.a2772f34-5542-4f68-a5ef-78f6ff367159_hg38', 'PCAWG.a31098f6-069b-4e0f-bfa4-2436ed3f2c83_hg38', 'PCAWG.a33ba465-7d43-43b9-b51e-63cb6b4b17b1_hg38', 'PCAWG.a3b32a24-0459-4a08-80a7-a5fc691778ec_hg38', 'PCAWG.a3dc8046-0bfb-4651-9bba-d1ee543760f5_hg38', 'PCAWG.a440c791-09a0-4ece-a66f-68ffe3f46ed3_hg38', 'PCAWG.a4810e79-175e-4265-a121-e02ffb961d67_hg38', 'PCAWG.a53c87f4-c412-475c-a3ee-e25b1a5bd8b7_hg38', 'PCAWG.a690a304-868b-4cea-9cf1-0554d89d632d_hg38', 'PCAWG.a803ef1b-d446-416a-a0ae-315f93ec5931_hg38', 'PCAWG.a9149509-bd61-445d-96d2-cb5a5a59ea20_hg38', 'PCAWG.a97c0700-9a9b-4609-971c-a327ff4f00ae_hg38', 'PCAWG.a9cfaf7f-7d15-4701-873f-b6284c9ecf65_hg38', 'PCAWG.a9f66b25-0f29-4f7d-8e98-fb00d3e7db70_hg38', 'PCAWG.aa1232dd-5839-4b48-9b9d-b309c160d8e8_hg38', 'PCAWG.aa5548d9-386a-4d6b-898b-69b95f43799c_hg38', 'PCAWG.ab4f8eea-ac47-4e0f-afed-3d236e5a4b4e_hg38', 'PCAWG.ac3415e7-6478-4168-b7b9-cace503e4fd8_hg38', 'PCAWG.ac6dcef2-856a-4bb7-9c9b-827b3128384c_hg38', 'PCAWG.ae31e275-6c07-47a6-9e75-de5f750af08f_hg38', 'PCAWG.aeab4756-0c2c-4117-ac11-ff6bcbe86104_hg38', 'PCAWG.af60508b-104f-4175-861f-9d64e277f467_hg38', 'PCAWG.af9e5e0d-db6b-4dee-84a6-c99462e9f71e_hg38', 'PCAWG.aff9470e-dcdc-4b2c-8501-ef223bcee213_hg38', 'PCAWG.b125aa08-5be2-485c-9d13-26d0d84ac750_hg38', 'PCAWG.b15cadc7-07df-488b-a8c2-c37d7e95f5ae_hg38', 'PCAWG.b2401fd9-439a-415a-a6a9-7210940641de_hg38', 'PCAWG.b6639e54-0943-446c-9cf2-a501ea704f04_hg38', 'PCAWG.b7c93acf-de6a-402e-a9b8-7644af214019_hg38', 'PCAWG.b82de11e-f66f-40c5-b4c6-912bc612162e_hg38', 'PCAWG.b842ff10-4722-4909-98e9-67d07204a573_hg38', 'PCAWG.b84b3813-ef9b-40ad-95d4-540a952b9acc_hg38', 'PCAWG.b8522c88-6735-404d-b0f8-40f3c8d3c7fe_hg38', 
	'PCAWG.b9774cc1-74c1-47a5-a60a-0703e2c2ab05_hg38', 'PCAWG.ba292cee-fbc9-4131-81d5-58c9f33964e0_hg38', 'PCAWG.baa5457a-3c81-4a05-895b-2daa80da053d_hg38', 'PCAWG.bab3d6d0-e5fb-4fb2-beb7-14f10ad52060_hg38', 'PCAWG.bac6cc92-1965-4b1f-93f5-868fe97b6e18_hg38', 'PCAWG.baef0f11-3318-48c4-a5e2-eefc2e2dd880_hg38', 'PCAWG.bba9295a-0645-43c1-8db8-0c9e4fdb764e_hg38', 'PCAWG.bcce406d-cad0-4aca-8c76-1960f3aca822_hg38', 'PCAWG.bf9e9dbb-6396-4a06-be98-23a03cca4d1c_hg38', 'PCAWG.bfc2690f-242b-40ca-96bc-2c162b9c3662_hg38', 'PCAWG.c04b93cf-17b9-464b-840d-9d98c7f4d9cd_hg38', 'PCAWG.c0f8b6f4-32f6-486d-8a12-a666b9af1103_hg38', 'PCAWG.c173c975-a554-4185-943a-6c4fffb20b8a_hg38', 'PCAWG.c1919b5c-eb8e-4e27-9f04-6b27ae601977_hg38', 'PCAWG.c2f81141-9049-4f87-adea-e62bebe73f68_hg38', 'PCAWG.c33ff38d-d5af-4b6b-8b70-a052085c2cf1_hg38', 'PCAWG.c389781f-a2ab-4f87-91fd-1d8457beb89c_hg38', 'PCAWG.c3eb8b5e-d2f6-4b75-9e92-0f719cac2e2d_hg38', 'PCAWG.c5ae6e34-7ea0-4279-a9c1-8aeaf19ba769_hg38', 'PCAWG.c5f349ab-586f-4754-b4ec-652698a4ca95_hg38', 'PCAWG.c6608cc3-a90f-48ab-ba0d-26d160ad0d23_hg38', 'PCAWG.c695cbf5-a62e-4e93-8189-28a6394bd3de_hg38', 'PCAWG.c791b69e-dd72-4837-9332-641b04c5c584_hg38', 'PCAWG.c865bc20-46ac-47bc-a346-d5d12dc3e866_hg38', 'PCAWG.c8d17103-3a0c-4f33-8268-a60182dbe338_hg38', 'PCAWG.cad1f8e8-b5fb-40de-acf6-aeeadefe83dd_hg38', 'PCAWG.cb516706-cea2-4e31-8780-793c2dff581f_hg38', 'PCAWG.cb827298-7792-4388-826d-c9e7b3fc5589_hg38', 'PCAWG.cbc2795a-5683-4116-a15a-4e032bc8a587_hg38', 'PCAWG.cd70c727-f427-4522-80aa-7341d6c3db47_hg38', 'PCAWG.cdccdb98-4446-41f2-bcf2-e5459a2e477d_hg38', 'PCAWG.d158346c-35f1-44a8-9d09-5513ae88bdc0_hg38', 'PCAWG.d20c849e-363e-4f24-96d7-9a13e08624ee_hg38', 'PCAWG.d57c1302-1da0-4fa6-8968-394d19e6b1f1_hg38', 'PCAWG.d5aca47a-8a2c-4902-b4bd-3201431ce97c_hg38', 'PCAWG.d5e6f3cc-6008-4c12-af9c-692683ca036b_hg38', 'PCAWG.d5eea982-1d22-4aa0-a507-6e1681792e6e_hg38', 'PCAWG.d6123885-e61d-4bd2-8aad-a9228431c571_hg38', 'PCAWG.d858067f-bfa5-4d74-8d9a-67f6aa0e9e40_hg38', 'PCAWG.db072704-e3a9-4bbc-90f9-4263444b3638_hg38', 'PCAWG.db7b3e6c-f2b6-42d7-8d06-deab49733108_hg38', 'PCAWG.dc3a71b5-2cf0-403e-9ec9-2175d659ae3f_hg38', 'PCAWG.dc9dccc2-3327-4b2c-9f18-99e468bc196a_hg38', 'PCAWG.dd5ea83d-2654-41cd-bc4e-675bb7e668a0_hg38', 'PCAWG.dd68b3d1-2470-4a4f-8850-53300e38ba55_hg38', 'PCAWG.dd7df5f1-6a83-429a-8b55-2a5ee392e308_hg38', 'PCAWG.de54d7fc-975b-4d28-8d9a-11850cb40e15_hg38', 'PCAWG.e0bee95d-3db2-4c44-9604-6526f755e889_hg38', 'PCAWG.e1b57ff4-a056-42d1-9568-7035682c8369_hg38', 'PCAWG.e219302a-7b99-4b08-8ac9-aec33b735f7a_hg38', 'PCAWG.e3b09af7-3350-4e69-92cf-e92475cad685_hg38', 'PCAWG.e4e4175b-f96c-47b6-a494-c087b3432e0c_hg38', 'PCAWG.e50d3820-9571-4451-94de-3ea1e93edce6_hg38', 'PCAWG.e623fefd-bedf-4ade-86f1-7a03cdce4a46_hg38', 'PCAWG.e90face2-45a7-4489-9669-2f679a4654c2_hg38', 'PCAWG.e94d7730-bd15-401b-9207-7daae57168e6_hg38', 'PCAWG.e98c4df4-88af-4752-8e0b-71b802589447_hg38', 'PCAWG.eaf41f88-c24a-4a34-961a-01b88c748d86_hg38', 
	'PCAWG.ebf32382-ceb2-4a97-bf6b-76d54ddbde0d_hg38', 'PCAWG.ecae9498-c909-47b2-9c62-5abec1b2cc55_hg38', 'PCAWG.ed44d6b1-e386-4b82-966b-eab3db45150a_hg38', 'PCAWG.ee2bbd42-af7e-4051-9ee5-ac1276d5ea8a_hg38', 'PCAWG.ee398c4d-c39b-4878-99f4-1513ee17aea2_hg38', 'PCAWG.f0c8b9b6-dc29-4cf1-ae2b-2963fb991fe5_hg38', 'PCAWG.f3dd5d7c-9093-408f-9ff4-5ed8e35438cc_hg38', 'PCAWG.f603ffc4-a161-4c30-b447-fdc12ee02481_hg38', 'PCAWG.f63a6acd-37c1-4a5d-acd7-f2d6c23e53a2_hg38', 'PCAWG.f666b1f2-2f73-47c1-96e4-5e9b1272645d_hg38', 'PCAWG.f6697c7f-f191-408b-93bc-17b7e62a4124_hg38', 'PCAWG.f6b71ed6-a4f5-4619-8029-cff157c699c7_hg38', 'PCAWG.f873ac33-9056-4efe-8205-847217a3ec91_hg38', 'PCAWG.f9642393-8019-49a3-9a13-0e31d51fa4bd_hg38', 'PCAWG.f96d6fa7-ea5b-45e6-9bf0-ecdd91761494_hg38', 'PCAWG.f98211ee-b704-4202-9c42-26e171022cd0_hg38', 'PCAWG.fa4fa49d-6d53-4ffa-9759-ffb884b28d17_hg38', 'PCAWG.fa7a917b-3692-408e-a23b-88d52f7b91d3_hg38', 'PCAWG.fb5bfc6c-2215-459d-8e51-520e3397b525_hg38', 'PCAWG.fba4f312-17ba-4de3-bc61-32a0b8da509f_hg38']]



out['Feature'] = out["Feature"].replace('-1','intergenic')
out = out.rename({"Start_b": "Start"}, axis=1)
out = out.rename({"End_b": "End"}, axis=1)
out = out.rename({"ID_b": "ID"}, axis=1)

out= out.drop_duplicates()


out.to_csv(args.outfile,sep = '\t',index = False)






